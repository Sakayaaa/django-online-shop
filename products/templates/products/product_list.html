{% extends 'core/base.html' %}
{% block title %}Products - DigiStore{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
  <h3 class="mb-0">Products</h3>
  <div class="small text-muted">
    {% if category %}
      Showing results for: <strong>{{ category.name }}</strong>
    {% else %}
      Showing all products
    {% endif %}
  </div>
</div>

<div class="row">
  <!-- Sidebar Filters -->
  <aside class="col-md-3">
    <div class="card p-3">
      <h6>Filters</h6>

      <!-- Category Filter -->
      <form method="get">
        <div class="mb-3">
          <label class="form-label">Category</label>
          <select name="category" class="form-select" onchange="this.form.submit()">
            <option value="">All</option>

            {% for c in all_categories %}
              <option value="{{ c.slug }}" 
                {% if category and c.slug == category.slug %}selected{% endif %}>
                {{ c.name }}
              </option>
            {% endfor %}
          </select>
        </div>
      </form>

      <!-- Brand filter — بعداً اضافه می‌کنی -->
      <div class="mb-3">
        <label class="form-label">Brand</label>
        <select class="form-select">
          <option>All</option>
        </select>
      </div>

    </div>
  </aside>

  <!-- Products -->
  <div class="col-md-9">
    <div class="row g-4">
      {% for p in products %}
        <div class="col-md-4">
          <div class="card product-card">

            {% if p.image %}
              <img src="{{ p.image.url }}" class="card-img-top" alt="{{ p.name }}">
            {% endif %}

            <div class="card-body">
              <h6>{{ p.name }}</h6>
              <p class="text-danger fw-bold">${{ p.price }}</p>

              <a href="{% url 'products:product_detail' p.pk %}" 
                 class="btn btn-outline-danger btn-sm w-100">
                View
              </a>
            </div>
          </div>
        </div>
      {% empty %}
        <p class="text-muted">No products found.</p>
      {% endfor %}
    </div>
  </div>
</div>
{% endblock %}
